"use strict";(self["webpackChunkvue_template_lyl"]=self["webpackChunkvue_template_lyl"]||[]).push([[26],{8026:function(t,e,i){i.r(e),i.d(e,{default:function(){return C}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"audioDetails"},[e("div",{staticClass:"virtual"},[e("div",{staticClass:"device"},[e("div",{staticClass:"reader"},[e("div",{staticClass:"main"},[t._m(0),t._m(1),t._m(2),e("div",{staticClass:"internal"},[e("CompactDisk",{directives:[{name:"show",rawName:"v-show",value:t.soundImage,expression:"soundImage"}],staticClass:"compactDisk",attrs:{image:t.soundImage}})],1)]),e("div",{staticClass:"logo"},[t._v("SHINSHA")])]),e("div",{staticClass:"panel"},[t._m(3),e("div",{staticClass:"player"},[e("div",{staticClass:"infoArea"},[e("div",{staticClass:"audioName"},[t._v(t._s(t.soundName))]),e("el-slider",{staticClass:"progressSlider",attrs:{max:t.soundTotalDuration,min:0,"show-tooltip":!1,disabled:0===t.soundTotalDuration},model:{value:t.soundCurrentDuration,callback:function(e){t.soundCurrentDuration=e},expression:"soundCurrentDuration"}})],1),e("div",{staticClass:"controlArea"},[e("div",{staticClass:"timeMonitor"},[t._v(" "+t._s(t.progressBarFormatTimeUtil(t.soundCurrentDuration))+" / "+t._s(t.progressBarFormatTimeUtil(t.soundTotalDuration))+" ")]),e("div",{staticClass:"control-group"},[e("LikeCom",{staticClass:"control-like",attrs:{id:t.soundId}}),e("div",{staticClass:"control-previous",on:{click:function(e){return t.switchSound("previous")}}},[e("span",{staticClass:"iconfont icon-bofangshangyige"})]),e("div",{staticClass:"control-play",on:{click:t.switchPlay}},[t.isPlay?e("span",{staticClass:"iconfont icon-zanting"}):e("span",{staticClass:"iconfont icon-bofang"})]),e("div",{staticClass:"control-next",on:{click:function(e){return t.switchSound("next")}}},[e("span",{staticClass:"iconfont icon-bofangxiayige"})]),e("div",{staticClass:"control-mode",on:{click:t.togglePlayMode}},[e("span",{directives:[{name:"show",rawName:"v-show",value:"shufflePlay"===t.mode,expression:"mode === 'shufflePlay'"}],staticClass:"iconfont icon-suijibofang"}),e("span",{directives:[{name:"show",rawName:"v-show",value:"loopList"===t.mode,expression:"mode === 'loopList'"}],staticClass:"iconfont icon-liebiaoxunhuan"}),e("span",{directives:[{name:"show",rawName:"v-show",value:"singleLoop"===t.mode,expression:"mode === 'singleLoop'"}],staticClass:"iconfont icon-danduxunhuan"})])],1),e("div",{staticClass:"control-volume"},[e("span",{staticClass:"iconfont icon-shengyin"}),e("el-slider",{staticClass:"volumeSlider",attrs:{min:0,max:100},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1)])])])]),e("div",{staticClass:"lyricsPanel"},[e("div",{staticClass:"monitor"},[e("ProgramLoading",{staticClass:"box"})],1)])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"desc"},[e("span",[t._v("CD")]),e("span",[t._v("VIRTUAL PLAYER")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"icon"},[e("span",[t._v("DISC")]),e("span",[t._v("DIGITAL AUDIO")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"shell"},[e("div",{staticClass:"block"}),e("div",{staticClass:"block"}),e("div",{staticClass:"block"}),e("div",{staticClass:"block"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"dashboard"},[e("div",{attrs:{id:"decibel"}}),e("div",{attrs:{id:"amplitude"}})])}],o=(i(6573),i(8100),i(7936),i(7467),i(4732),i(4339),i(9671)),l=i(3518),n=i(619),r=i(1089),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},t._l(t.displayLines,(function(i,s){return e("p",{key:s,domProps:{innerHTML:t._s(i)}})})),0)},h=[],u={data(){return{lines:["^| Start Self-test Program","^| Virtual device rendering successful","^| Detect that personal server is offline, Lyrics rendering failed","^| Foreseeable Errors, Please do not contact the administrator","^|","^| Load Reserve Information","^| Welcome to SHINSHA brand's virtual devices","^| We sincerely thank you for choosing our brand's equipment","^| Wish you a pleasant experience!","^| ","^| End"],displayLines:[]}},methods:{startLoadingEffect(){let t=0,e=0;const i=500,s=20,a=()=>{e<this.lines[t].length?(this.displayLines.splice(t,1,this.displayLines[t]+this.lines[t][e]),e++,setTimeout(a,s)):(e=0,t++,t<this.lines.length&&setTimeout(o,i))},o=()=>{setTimeout(a,s)};o()}},computed:{formattedLines(){return this.displayLines.map((t=>t||"&nbsp;"))}},watch:{},created(){},mounted(){setTimeout((()=>{this.displayLines=this.lines.map((()=>"")),this.startLoadingEffect()}),1e3)},beforeDestroy(){}},c=u,p=i(1656),m=(0,p.A)(c,d,h,!1,null,"239919c6",null),y=m.exports,v={name:"AudioDetails",components:{ProgramLoading:y},data(){return{isPlay:!1,volume:(0,r.Gq)("volume")||40,mode:(0,r.Gq)("palyMode")||"loopList",modeIndex:1,soundId:null,soundName:"",soundImage:null,soundModel:null,soundModelId:null,soundURL:null,soundTotalDuration:0,soundCurrentDuration:0,soundNewDuration:0,audioContext:null,analyser:null,audioDataArray:null,animationId:null,decibeChart:null,decibeOption:null,amplitudeChart:null,amplitudeOption:null}},methods:{createSoundModel(){this.soundModel&&(this.isPlay=!1,this.soundModel.unload()),this.soundURL=this.playList[this.playIndex].soundPath,this.soundModel=new n.Howl({src:this.soundURL}),this.soundModelId=this.soundModel._sounds[0]._id,this.soundModel.on("end",(()=>{this.playModeHelper()})),this.soundModel.on("play",(()=>{this.setupAudioContext(),this.updateLevelMeter()})),this.soundModel.on("pause",(()=>{setTimeout((()=>{cancelAnimationFrame(this.animationId)}),1e3)}))},pauseSoundHelper(){this.isPlay=!1,this.soundModelId&&this.soundModel.pause(this.soundModelId)},playSoundHelper(){this.isPlay=!0,this.soundModelId&&this.soundModel.play(this.soundModelId)},switchPlay(){if(0===this.playList.length)return this.$message.warning("Your playlist is empty");this.soundModel&&null!==this.playIndex||(this.$store.commit("changePlayIndex",0),this.$store.commit("activePlayTrigger")),this.isPlay=!this.isPlay,this.isPlay?this.playSoundHelper():this.pauseSoundHelper()},switchSound(t){if(0===this.playList.length)return this.$message.warning("Your playlist is empty");if(1===this.playList.length)return this.$message.warning("Your playlist is just one song");if("next"===t){if("shufflePlay"===this.mode)return this.randomizePlayHelper();this.playIndex+1===this.playList.length?this.$store.commit("changePlayIndex",0):this.$store.commit("changePlayIndex",this.playIndex+1)}"previous"===t&&(0===this.playIndex?this.$store.commit("changePlayIndex",this.playList.length-1):this.$store.commit("changePlayIndex",this.playIndex-1)),this.$store.commit("activePlayTrigger")},togglePlayMode(){this.modeIndex<3?this.modeIndex+=1:this.modeIndex=1,1===this.modeIndex&&(this.mode="loopList",this.$notify({title:"Paly Mode",message:"list loop",position:"bottom-right",showClose:!1,duration:2500})),2===this.modeIndex&&(this.mode="singleLoop",this.$notify({title:"Paly Mode",message:"single loop",position:"bottom-right",showClose:!1,duration:2500})),3===this.modeIndex&&(this.mode="shufflePlay",this.$notify({title:"Paly Mode",message:"shuffle play",position:"bottom-right",showClose:!1,duration:2500})),(0,r.SO)("palyMode",this.mode)},playModeHelper(){"loopList"===this.mode&&(this.playIndex+1===this.playList.length?this.$store.commit("changePlayIndex",0):this.$store.commit("changePlayIndex",this.playIndex+1),this.$store.commit("activePlayTrigger")),"singleLoop"===this.mode&&this.$store.commit("activePlayTrigger"),"shufflePlay"===this.mode&&this.randomizePlayHelper(),1===this.playList.length&&this.playSoundHelper()},randomizePlayHelper(){const t=Math.floor(Math.random()*this.playList.length);if(t===this.playIndex&&1!==this.playList.length)return this.randomizePlayHelper();this.$store.commit("changePlayIndex",t),this.$store.commit("activePlayTrigger")},progressBarFormatTimeUtil(t){const e=Math.floor(t/60),i=t%60,s=String(e).padStart(2,"0"),a=String(i).padStart(2,"0");return`${s}:${a}`},setDecibelOption(){this.decibeOption={series:[{name:"Pressure",type:"gauge",animation:!1,radius:"85%",center:["50%","50%"],min:-60,max:0,progress:{show:!1},axisLine:{lineStyle:{color:[[.7333,"#37ef46"],[.9,"#f5d246"],[1,"#f54646"]],width:this.calculateAdaptivePixelUtil(10)}},pointer:{itemStyle:{color:"#e6ebf8"}},splitNumber:12,axisLabel:{show:!1},axisTick:{show:this.calculateAdaptivePixelUtil(10)>8,lineStyle:{color:"#e6ebf8"}},splitLine:{length:this.calculateAdaptivePixelUtil(8),lineStyle:{color:"#e6ebf8",width:this.calculateAdaptivePixelUtil(2)}},detail:{formatter:function(t){return t.toFixed(1)},offsetCenter:[0,"80%"],fontSize:this.calculateAdaptivePixelUtil(20),textStyle:{color:"#e6ebf8"}},title:{show:!0,offsetCenter:[0,"35%"],fontSize:this.calculateAdaptivePixelUtil(14),color:"#666"},data:[{value:-60,name:"dB"}]}]}},setAmplitudeOption(){this.amplitudeOption={series:[{name:"Pressure",type:"gauge",animation:!1,radius:"85%",center:["50%","50%"],min:0,max:100,progress:{show:!0,width:this.calculateAdaptivePixelUtil(10),itemStyle:{color:"#409eff"}},axisLine:{lineStyle:{width:this.calculateAdaptivePixelUtil(10),color:[[1,"#666"]]}},pointer:{itemStyle:{color:"#e6ebf8"}},splitNumber:10,axisLabel:{show:!1},axisTick:{show:this.calculateAdaptivePixelUtil(10)>8,lineStyle:{color:"#e6ebf8"}},splitLine:{length:this.calculateAdaptivePixelUtil(8),lineStyle:{color:"#e6ebf8",width:this.calculateAdaptivePixelUtil(2)}},detail:{formatter:"{value}",offsetCenter:[0,"80%"],fontSize:this.calculateAdaptivePixelUtil(20),textStyle:{color:"#e6ebf8"}},title:{show:!0,offsetCenter:[0,"35%"],fontSize:this.calculateAdaptivePixelUtil(14),color:"#666"},data:[{value:0,name:"NA"}]}]}},calculateAdaptivePixelUtil(t,e=1920){const i=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);return t/e*i},createDashboard(){this.decibeChart=o.Ts(document.getElementById("decibel")),this.setDecibelOption(),this.decibeOption&&this.decibeChart.setOption(this.decibeOption),this.amplitudeChart=o.Ts(document.getElementById("amplitude")),this.setAmplitudeOption(),this.amplitudeOption&&this.amplitudeChart.setOption(this.amplitudeOption),window.onresize=()=>{this.setDecibelOption(),this.decibeOption&&this.decibeChart.setOption(this.decibeOption),this.decibeChart.resize(),this.setAmplitudeOption(),this.amplitudeOption&&this.amplitudeChart.setOption(this.amplitudeOption),this.amplitudeChart.resize()}},setupAudioContext(){this.audioContext=n.Howler.ctx,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,n.Howler.masterGain.connect(this.analyser),this.audioDataArray=new Uint8Array(this.analyser.frequencyBinCount)},updateLevelMeter(){this.analyser.getByteFrequencyData(this.audioDataArray);let t=0;for(let n=0;n<this.audioDataArray.length;n++)t+=this.audioDataArray[n]*this.audioDataArray[n];const e=Math.sqrt(t/this.audioDataArray.length),i=20*Math.log10(e/255),s=Math.max(-60,Math.min(0,i));this.analyser.getByteTimeDomainData(this.audioDataArray);let a=0;for(let n=0;n<this.audioDataArray.length;n++){const t=this.audioDataArray[n]/128-1;a+=t*t}const o=Math.sqrt(a/this.audioDataArray.length),l=100*Math.min(1,2*o);this.decibeOption.series[0].data[0].value=s,this.decibeChart.setOption(this.decibeOption),this.amplitudeOption.series[0].data[0].value=l.toFixed(1),this.amplitudeChart.setOption(this.amplitudeOption),this.animationId=requestAnimationFrame(this.updateLevelMeter)},resetPlayer(){n.Howler.unload(),this.isPlay=!1,this.soundName="",this.soundImage=null,this.soundId=null,this.$store.commit("changePlayId",null),this.$store.commit("changePlayIndex",null),this.soundCurrentDuration=0,this.$nextTick((()=>{this.soundTotalDuration=0})),cancelAnimationFrame(this.animationId),this.$nextTick((()=>{this.decibeOption.series[0].data[0].value=-60,this.decibeChart.setOption(this.decibeOption),this.amplitudeOption.series[0].data[0].value=0,this.amplitudeChart.setOption(this.amplitudeOption)}))}},computed:{...(0,l.aH)(["playId","playList","playIndex","playListId"]),...(0,l.aH)(["playTrigger","switchPlayTrigger","resetPlayerTrigger"])},watch:{volume:{handler(){n.Howler.volume(this.volume/100),(0,r.SO)("volume",this.volume)},immediate:!0},playTrigger(){if(0===this.playList.length)return this.resetPlayer();this.createSoundModel(),this.soundId=this.playList[this.playIndex].soundId,this.$store.commit("changePlayId",this.soundId),this.soundName=this.playList[this.playIndex].soundName,this.soundImage=this.playList[this.playIndex].albumImage,this.soundCurrentDuration=0,this.$nextTick((()=>{this.soundTotalDuration=0})),this.playSoundHelper()},switchPlayTrigger(){this.switchPlay()},resetPlayerTrigger(){this.resetPlayer()},isPlay(){const t=setInterval((()=>{if(!this.isPlay)return clearInterval(t);0!==this.playList.length&&(this.soundTotalDuration=Math.floor(this.soundModel.duration()),this.soundCurrentDuration=Math.floor(this.soundModel.seek(this.soundModelId)))}),500)},soundCurrentDuration(t,e){t-e!==1&&this.soundModel.seek(this.soundCurrentDuration,this.soundModelId)}},created(){},activated(){this.setDecibelOption(),this.decibeOption&&this.decibeChart.setOption(this.decibeOption),this.decibeChart.resize(),this.setAmplitudeOption(),this.amplitudeOption&&this.amplitudeChart.setOption(this.amplitudeOption),this.amplitudeChart.resize()},mounted(){this.createDashboard(),document.addEventListener("keydown",(t=>{if("Space"===t.code&&(t.preventDefault(),this.switchPlay()),"ArrowUp"===t.code){t.preventDefault();const e=this.volume+5;this.volume=e>95?100:e}if("ArrowDown"===t.code){t.preventDefault();const e=this.volume-5;this.volume=e<4?0:e}}))},beforeDestroy(){}},g=v,f=(0,p.A)(g,s,a,!1,null,"3fc61223",null),C=f.exports}}]);